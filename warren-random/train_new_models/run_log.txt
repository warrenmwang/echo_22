  0%|                                                                                      | 0/16 [00:00<?, ?it/s]  6%|████▉                                                                         | 1/16 [00:00<00:05,  2.72it/s] 31%|████████████████████████▍                                                     | 5/16 [00:00<00:01,  9.09it/s] 56%|███████████████████████████████████████████▉                                  | 9/16 [00:00<00:00, 10.17it/s] 81%|██████████████████████████████████████████████████████████████▌              | 13/16 [00:01<00:00, 13.52it/s]100%|█████████████████████████████████████████████████████████████████████████████| 16/16 [00:01<00:00, 13.47it/s]
  0%|                                                                                      | 0/16 [00:00<?, ?it/s]  6%|████▉                                                                         | 1/16 [00:00<00:04,  3.08it/s] 31%|████████████████████████▍                                                     | 5/16 [00:00<00:01, 10.97it/s] 56%|███████████████████████████████████████████▉                                  | 9/16 [00:00<00:00, 13.03it/s] 81%|██████████████████████████████████████████████████████████████▌              | 13/16 [00:00<00:00, 15.52it/s]100%|█████████████████████████████████████████████████████████████████████████████| 16/16 [00:01<00:00, 16.84it/s]100%|█████████████████████████████████████████████████████████████████████████████| 16/16 [00:01<00:00, 13.97it/s]dropout_v3_0_25_R2plus1D_18_MotionNet.pth has 31575731 parameters.
-------------------------------- Epoch 1 --------------------------------



Train Epoch: 1 [1120/7332 (15%)]	Loss: 0.836855
ED LV: 0.822
ES LV: 0.743
On a particular batch:
Deform loss:  tensor(0.0111, device='cuda:0', grad_fn=<DivBackward0>)
Segmentation loss:  tensor(0.2701, device='cuda:0', grad_fn=<DivBackward0>)
Seg Motion loss:  tensor(0.2636, device='cuda:0', grad_fn=<DivBackward0>) tensor(0.0207, device='cuda:0', grad_fn=<DivBackward0>)

Train Epoch: 1 [2240/7332 (31%)]	Loss: 0.647291
ED LV: 0.869
ES LV: 0.811
On a particular batch:
Deform loss:  tensor(0.0096, device='cuda:0', grad_fn=<DivBackward0>)
Segmentation loss:  tensor(0.1709, device='cuda:0', grad_fn=<DivBackward0>)
Seg Motion loss:  tensor(0.1701, device='cuda:0', grad_fn=<DivBackward0>) tensor(0.0196, device='cuda:0', grad_fn=<DivBackward0>)

Train Epoch: 1 [3360/7332 (46%)]	Loss: 0.532924
ED LV: 0.886
ES LV: 0.838
On a particular batch:
Deform loss:  tensor(0.0087, device='cuda:0', grad_fn=<DivBackward0>)
Segmentation loss:  tensor(0.1112, device='cuda:0', grad_fn=<DivBackward0>)
Seg Motion loss:  tensor(0.1158, device='cuda:0', grad_fn=<DivBackward0>) tensor(0.0156, device='cuda:0', grad_fn=<DivBackward0>)

Train Epoch: 1 [4480/7332 (61%)]	Loss: 0.452598
ED LV: 0.897
ES LV: 0.854
On a particular batch:
Deform loss:  tensor(0.0092, device='cuda:0', grad_fn=<DivBackward0>)
Segmentation loss:  tensor(0.0754, device='cuda:0', grad_fn=<DivBackward0>)
Seg Motion loss:  tensor(0.0773, device='cuda:0', grad_fn=<DivBackward0>) tensor(0.0161, device='cuda:0', grad_fn=<DivBackward0>)

Train Epoch: 1 [5600/7332 (76%)]	Loss: 0.395875
ED LV: 0.903
ES LV: 0.864
On a particular batch:
Deform loss:  tensor(0.0076, device='cuda:0', grad_fn=<DivBackward0>)
Segmentation loss:  tensor(0.0666, device='cuda:0', grad_fn=<DivBackward0>)
Seg Motion loss:  tensor(0.0574, device='cuda:0', grad_fn=<DivBackward0>) tensor(0.0159, device='cuda:0', grad_fn=<DivBackward0>)

Train Epoch: 1 [6720/7332 (92%)]	Loss: 0.352492
ED LV: 0.908
ES LV: 0.871
On a particular batch:
Deform loss:  tensor(0.0065, device='cuda:0', grad_fn=<DivBackward0>)
Segmentation loss:  tensor(0.0578, device='cuda:0', grad_fn=<DivBackward0>)
Seg Motion loss:  tensor(0.0449, device='cuda:0', grad_fn=<DivBackward0>) tensor(0.0143, device='cuda:0', grad_fn=<DivBackward0>)
training took 2133.87392139 seconds

------------------------------Validation------------------------------

ED LV: 0.934
ES LV: 0.909

Valid set: Average loss: 0.1068

-------------------------------- Epoch 2 --------------------------------


Train Epoch: 2 [1120/7332 (15%)]	Loss: 0.107916
ED LV: 0.934
ES LV: 0.910
On a particular batch:
Deform loss:  tensor(0.0062, device='cuda:0', grad_fn=<DivBackward0>)
Segmentation loss:  tensor(0.0398, device='cuda:0', grad_fn=<DivBackward0>)
Seg Motion loss:  tensor(0.0314, device='cuda:0', grad_fn=<DivBackward0>) tensor(0.0114, device='cuda:0', grad_fn=<DivBackward0>)

Train Epoch: 2 [2240/7332 (31%)]	Loss: 0.103313
ED LV: 0.933
ES LV: 0.909
On a particular batch:
Deform loss:  tensor(0.0054, device='cuda:0', grad_fn=<DivBackward0>)
Segmentation loss:  tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)
Seg Motion loss:  tensor(0.0273, device='cuda:0', grad_fn=<DivBackward0>) tensor(0.0128, device='cuda:0', grad_fn=<DivBackward0>)

Train Epoch: 2 [3360/7332 (46%)]	Loss: 0.099489
ED LV: 0.933
ES LV: 0.909
On a particular batch:
Deform loss:  tensor(0.0079, device='cuda:0', grad_fn=<DivBackward0>)
Segmentation loss:  tensor(0.0664, device='cuda:0', grad_fn=<DivBackward0>)
Seg Motion loss:  tensor(0.0293, device='cuda:0', grad_fn=<DivBackward0>) tensor(0.0222, device='cuda:0', grad_fn=<DivBackward0>)

Train Epoch: 2 [4480/7332 (61%)]	Loss: 0.096046
ED LV: 0.933
ES LV: 0.909
On a particular batch:
Deform loss:  tensor(0.0048, device='cuda:0', grad_fn=<DivBackward0>)
Segmentation loss:  tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)
Seg Motion loss:  tensor(0.0221, device='cuda:0', grad_fn=<DivBackward0>) tensor(0.0135, device='cuda:0', grad_fn=<DivBackward0>)

Train Epoch: 2 [5600/7332 (76%)]	Loss: 0.094399
ED LV: 0.932
ES LV: 0.909
On a particular batch:
Deform loss:  tensor(0.0066, device='cuda:0', grad_fn=<DivBackward0>)
Segmentation loss:  tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)
Seg Motion loss:  tensor(0.0209, device='cuda:0', grad_fn=<DivBackward0>) tensor(0.0134, device='cuda:0', grad_fn=<DivBackward0>)

Train Epoch: 2 [6720/7332 (92%)]	Loss: 0.091743
ED LV: 0.932
ES LV: 0.909
On a particular batch:
Deform loss:  tensor(0.0046, device='cuda:0', grad_fn=<DivBackward0>)
Segmentation loss:  tensor(0.0297, device='cuda:0', grad_fn=<DivBackward0>)
Seg Motion loss:  tensor(0.0173, device='cuda:0', grad_fn=<DivBackward0>) tensor(0.0100, device='cuda:0', grad_fn=<DivBackward0>)
Traceback (most recent call last):
  File "train_new_model_2.py", line 183, in <module>
    train_loss = train(epoch, train_loader=train_dataloader, model=model, optimizer=optimizer)
  File "/home/wang/workspace/JupyterNoteBooksAll/fully-automated-multi-heartbeat-echocardiography-video-segmentation-and-motion-tracking/src/train_test.py", line 286, in train
    optimizer.step()
  File "/opt/anaconda3/envs/dynamic37-wang/lib/python3.7/site-packages/torch/autograd/grad_mode.py", line 15, in decorate_context
    return func(*args, **kwargs)
  File "/opt/anaconda3/envs/dynamic37-wang/lib/python3.7/site-packages/torch/optim/adam.py", line 107, in step
    denom = (exp_avg_sq.sqrt() / math.sqrt(bias_correction2)).add_(group['eps'])
RuntimeError: CUDA error: an illegal memory access was encountered

real	72m49.870s
user	164m10.340s
sys	23m6.765s
fin
